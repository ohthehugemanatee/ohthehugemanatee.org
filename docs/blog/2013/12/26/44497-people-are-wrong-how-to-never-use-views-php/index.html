<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.92.1" />

    
    
    

<title>44,497 people are wrong: how to NEVER need Views PHP. • Oh The Huge Manatee!</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="44,497 people are wrong: how to NEVER need Views PHP."/>
<meta name="twitter:description" content="You&rsquo;re building a View, but you can&rsquo;t get that field to display the way you want it to. Or filter, or sort. Or maybe you have some data in a custom table that you want to include in the View. So you look for a contributed module, and Views PHP looks like the answer to your problem! Until you read the module page, where it says:
 &ldquo;&hellip;it is highly advisable to use regular handlers and plugins when available (or even to create one yourself)."/>

<meta property="og:title" content="44,497 people are wrong: how to NEVER need Views PHP." />
<meta property="og:description" content="You&rsquo;re building a View, but you can&rsquo;t get that field to display the way you want it to. Or filter, or sort. Or maybe you have some data in a custom table that you want to include in the View. So you look for a contributed module, and Views PHP looks like the answer to your problem! Until you read the module page, where it says:
 &ldquo;&hellip;it is highly advisable to use regular handlers and plugins when available (or even to create one yourself)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohthehugemanatee.org/blog/2013/12/26/44497-people-are-wrong-how-to-never-use-views-php/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2013-12-26T12:01:44+00:00" />
<meta property="article:modified_time" content="2013-12-26T12:01:44+00:00" />



    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.3081c4981fb69a2783dd36ecfdd0e6ba7a158d4cbfdd290ebce8f78ba0469fc6.css" integrity="sha256-MIHEmB&#43;2mieD3Tbs/dDmunoVjUy/3SkOvOj3i6BGn8Y=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

<link rel="stylesheet" href="/scss/custom.c9bb9cdc7e3b8c0c27464cdd02ce48b05b01c1737cdbff727ae9152da7d3b432.css" integrity="sha256-ybuc3H47jAwnRkzdAs5IsFsBwXN82/9yeukVLafTtDI=">

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://ohthehugemanatee.org/">
        
          Oh The Huge Manatee!
        
        </a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://ohthehugemanatee.org/images/oh_the_huge_manatee.png" alt="Author Image" class="img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         Thoughts and technical notes from the field. I&#39;m Campbell Vertesi, Global Partner Strategy ISV CTO for Red Hat at Microsoft, opera singer, and parent. These are the things that go through my mind. 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Oh The Huge Manatee!</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/about">
						<span>About Me</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/">
						<span>Blog</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/campbellvertesi" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://github.com/ohthehugemanatee" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/campbellvertesi" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>44,497 people are wrong: how to NEVER need Views PHP.</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Dec 26, 2013
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/drupal">DRUPAL</a>
              •
          
              <a class="badge badge-category" href="/categories/drupalplanet">DRUPALPLANET</a>
              •
          
              <a class="badge badge-category" href="/categories/howto">HOWTO</a>
              •
          
              <a class="badge badge-category" href="/categories/views">VIEWS</a>
              
          
      
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 9 min read
</div>


  </header>
  
  
  <div class="post">
    <p>You&rsquo;re building a View, but you can&rsquo;t get that field to display the way you want it to. Or filter, or sort. Or maybe you have some data in a custom table that you want to include in the View. So you look for a contributed module, and <a href="https://www.drupal.org/project/views_php">Views PHP</a> looks like the answer to your problem! Until you read the module page, where it says:</p>
<blockquote>
<p>&ldquo;&hellip;it is highly advisable to use regular handlers and plugins when available (or even to create one yourself). Take note that filtering and sorting a view using PHP always has a considerable perfomance impact.&rdquo;</p>
</blockquote>
<p>As of this writing, <em>44,497</em> site maintainers have read that warning and chosen to ignore it. <strong>They&rsquo;ve chosen to put their PHP into a non-revisioned, difficult-to-access place, and to enable PHP input in a module that was never designed for security. They&rsquo;ve left their site at risk of a very difficult to diagnose and even harder to fix WSOD</strong>.</p>
<p>I&rsquo;m going to go out on a limb here, and suggest that in many of these cases, the decision was made because someone had the impression that writing a Views handler or Plugin was difficult. I&rsquo;m here to tell you that&rsquo;s not so: it&rsquo;s actually quite easy.</p>
<h2 id="what-were-doing">What we&rsquo;re doing</h2>
<p>We&rsquo;re going to tell Views about the structure of the data we want to display, filter, or sort - even if there&rsquo;s not actually a new data source involved, that&rsquo;s how you do it - and then we&rsquo;ll write the function that actually does the filter/sort/etc by improving an existing field display/filter/sort that Views already includes.</p>
<p>This process will work for:</p>
<ul>
<li>Defining a new data source for Views, ie something your module keeps in the DB.</li>
<li>Creating multiple field displays/filters/sorts for an existing field.</li>
<li>Creating a completely computed field display/filter/sort, with nothing in the DB.</li>
</ul>
<p>I know that in 99% of use cases for Views PHP, you don&rsquo;t need to define a new data source, table, adn fields. Trust me that this is the easiest way to learn it, though. I promise we&rsquo;ll get to your use case before the end of the post.</p>
<h1 id="how-to">How to</h1>
<p>I&rsquo;ll assume you have a custom module built, with a .info and .module file, but nothing in there yet. We&rsquo;ll call our module &ldquo;mymodule&rdquo; for the example.</p>
<ol>
<li>Tell Views about your module</li>
</ol>
<hr>
<p>We implement <em><a href="https://api.drupal.org/api/views/views.api.php/function/hook_views_api/7">hook_views_api</a></em> to let Views know that our module provides some code for Views, and what version of the Views API we&rsquo;re using.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>

<span style="color:#e6db74">/**
</span><span style="color:#e6db74"> * Implements hook_views_api().
</span><span style="color:#e6db74"> */</span>
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mymodule_views_api</span>() {
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">array</span>(
    <span style="color:#e6db74">&#39;api&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>,
    <span style="color:#e6db74">&#39;path&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">drupal_get_path</span>(<span style="color:#e6db74">&#39;module&#39;</span>, <span style="color:#e6db74">&#39;mymodule&#39;</span>) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/views&#39;</span>,
  );
}
</code></pre></div><p>Couldn&rsquo;t be simpler. We declare that we&rsquo;re using Views API 3, and that our Views code will all live in the <em>/views</em> subdirectory of our module.</p>
<ol start="2">
<li>Tell Views about your custom code</li>
</ol>
<hr>
<p>Now that Views knows to look in our <em>/views</em> directory, we should populate it. Views will look for a file called <em>modulename.views.inc</em> in that directory, so this is where we will put our Views hooks. There are lots of Views interventions you can do in this file, but we&rsquo;re only interested in one: <em><a href="https://api.drupal.org/api/views/views.api.php/function/hook_views_data/7">hook_views_data</a></em>.</p>
<p>This hook lets you define new data sources to Views, and for each one show how to render a field, how to Filter results, and how to Sort results based on your new data source. I promised you three use cases up there though, and here&rsquo;s the trick: you don&rsquo;t have to have an actual data source. You can define a filter for a database field that&rsquo;s already described elsewhere.</p>
<p>First let&rsquo;s look at a real field definiton though, because it&rsquo;s simpler. Here&rsquo;s how we would define a real DB table as a data source. The table looks like this:</p>
<!-- raw HTML omitted -->
<p>So here&rsquo;s our implementation of <em>hook_views_data</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#e6db74">/**
</span><span style="color:#e6db74"> * Implements hook_views_data().
</span><span style="color:#e6db74"> */</span>
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mymodule_views_data</span>() {
  <span style="color:#75715e">// Build an array named after each DB table you&#39;re describing. In our case,
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// just mymodule_table.
</span><span style="color:#75715e"></span>  $data[<span style="color:#e6db74">&#39;mymodule_table&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(
    <span style="color:#75715e">// First give some general information about the table as a data source.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;table&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#75715e">// The grouping for this field/filter/sort in the Views UI.
</span><span style="color:#75715e"></span>      <span style="color:#e6db74">&#39;group&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Example Views Stuff&#39;</span>),
      <span style="color:#e6db74">&#39;base&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;naid&#39;</span>, <span style="color:#75715e">// This is the identifier field for the view.
</span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Example Views API Data&#39;</span>),
        <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Names provided by the Mymodule module.&#39;</span>),
      ),
    ),
    <span style="color:#75715e">// Now we describe each field that Views needs to know about, starting 
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// with the identifier field.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;naid&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Name ID&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#34;The unique Name ID.&#34;</span>),
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_field_numeric&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
      ),
      <span style="color:#e6db74">&#39;sort&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_sort&#39;</span>,
      ),
      <span style="color:#e6db74">&#39;filter&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_filter_numeric&#39;</span>,
      ),
    ),
    <span style="color:#75715e">// Now the name field.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Name&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#34;The Name.&#34;</span>),
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_field&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
      ),
      <span style="color:#e6db74">&#39;sort&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_sort&#39;</span>,
      ),
      <span style="color:#e6db74">&#39;filter&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;views_handler_filter_string&#39;</span>,
      ),
    ),
  );
  <span style="color:#66d9ef">return</span> $data;
}
</code></pre></div><p>This is a pretty simple example, and I think the array structure speaks for itself. First you provide some general information about the table, then you create a sub-array for each field on the table. Each field&rsquo;s array should be named after the field, and provide at least title. Of course it wouldn&rsquo;t be useful if you didn&rsquo;t describe the handlers for any field/sort/filter operations you want to expose. For each one of these you just provide the name of the handler. In this example I used all built-in filters that come with Views, but it&rsquo;s easy enough to provide a custom handler.</p>
<p>Many added behaviors in Views start with <em>hook_views_data</em>; this only covers the basics. You can also open fields up as arguments or relationships, or even add built-in relationships. For example, if our table also contained an NID field, we could define a relationship so that node fields are always available when listing names, and vice versa. This stuff is all surprisingly easy to do, it&rsquo;s just not the focus of this post.</p>
<ol start="3">
<li>Write your custom handler</li>
</ol>
<hr>
<p>Let&rsquo;s say we want to provide our own field handler for the name field. Maybe we want it to automatically separate first names. This is easy, too! You simply decide on a name for your new handler - by convention it should begin with <em>modulename_handler_type_</em>, so we&rsquo;ll use <em>mymodule_handler_field_firstname</em>. Here&rsquo;s the relevant part of that <em>$data</em> array from before:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">...</span>
    <span style="color:#75715e">// Now the name field.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Name&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#34;The Name.&#34;</span>),
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mymodule_handler_field_firstname&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
      ),
<span style="color:#f92672">...</span>
</code></pre></div><p>Not exactly rocket science, is it?</p>
<p>Now we create a file named after the handler, also in the <em>/views</em> subdirectory. Though you could write your own handler class from scratch, you&rsquo;ll almost never have to. It&rsquo;s much easier to just extend an existing class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>

<span style="color:#e6db74">/**
</span><span style="color:#e6db74"> * @file
</span><span style="color:#e6db74"> * Definition of mymodule_handler_field_firstname.
</span><span style="color:#e6db74"> */</span>

<span style="color:#e6db74">/**
</span><span style="color:#e6db74"> * Provide the first name only from the name field.
</span><span style="color:#e6db74"> *
</span><span style="color:#e6db74"> * @ingroup views_filter_handlers
</span><span style="color:#e6db74"> */</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">mymodule_handler_field_firstname</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">views_handler_field</span> {
  <span style="color:#e6db74">/**
</span><span style="color:#e6db74">  * Render the name field.
</span><span style="color:#e6db74">  */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">render</span>($values) {
    $value <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get_value</span>($values);
    $return <span style="color:#f92672">=</span> <span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#39; &#39;</span>, $value);
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;First name: &#39;</span> <span style="color:#f92672">.</span> $return[<span style="color:#e6db74">&#39;0&#39;</span>];
  }
}
</code></pre></div><p>You see the pattern we&rsquo;re following: just name a handler, then extend an existing Views handler class to do what you want. You can override options forms, the admin summary&hellip; really any aspect of the way Views handles this data. And the pattern is the same for fields, sorts, filters, and arguments.</p>
<p>Once you&rsquo;ve created your handler&rsquo;s <em>.inc</em> file, you have to make sure your module loads it. So edit your module&rsquo;s <em>.info</em> file thusly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">My Module</span>
<span style="color:#a6e22e">description</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">Demo module from ohthehugemanatee.org</span>
<span style="color:#a6e22e">core</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7.x</span>

<span style="color:#a6e22e">files[]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">views/mymodule_handler_field_firstname.inc</span>
</code></pre></div><ol start="4">
<li>Multiple filters for one field</li>
</ol>
<hr>
<p>We all understand how this works for data that you&rsquo;re declaring for the first time in Views. But what if you want to provide multiple handlers for a single field? Maybe there are several different ways to filter or sort it. For most use cases, you should just follow the pattern above, and simply override the Views options form in your handler class. But occasionally you really do need multiple handlers.</p>
<p>So let&rsquo;s add a second and third field handler for our <em>name</em> field:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">...</span>
    <span style="color:#75715e">// Now the name field. This is the first, and &#39;real&#39; definition for this field.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Name&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#34;The Name.&#34;</span>),
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mymodule_handler_field_firstname&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
      ),
    ),
    <span style="color:#e6db74">&#39;name_last&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Last name&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;The Last name, extracted from the Name field&#39;</span>),
      <span style="color:#e6db74">&#39;real field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;name&#39;</span>,
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mymodule_handler_field_lastname&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
      ),
    ),
    <span style="color:#e6db74">&#39;name_backwards&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
      <span style="color:#e6db74">&#39;title&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;Evil Genius Name&#39;</span>),
      <span style="color:#e6db74">&#39;help&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">t</span>(<span style="color:#e6db74">&#39;The name, reversed so it sounds like the name of an evil genius.&#39;</span>),
      <span style="color:#e6db74">&#39;real field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;name&#39;</span>,
      <span style="color:#e6db74">&#39;field&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(
        <span style="color:#e6db74">&#39;handler&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mymodule_handler_field_evil&#39;</span>,
        <span style="color:#e6db74">&#39;click sortable&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">TRUE</span>,
        ),
      ),
<span style="color:#f92672">...</span>
</code></pre></div><p>Can you spot the difference? All you have to do is add a variable for <em>real field</em>, which tells Views the field name to use for the source value, and that&rsquo;s it. Everything else is totally identical to a normal field. By custom we prefix the &ldquo;virtual&rdquo; field&rsquo;s name with the name of the real field, but that&rsquo;s as complicated as it gets.</p>
<h1 id="conclusion">Conclusion</h1>
<p>If there&rsquo;s one thing I want you to take away from this blog post, it&rsquo;s that <strong>the Views API is actually really easy</strong>. And if you can&rsquo;t find something online, take a moment to actually look at the <a href="https://api.drupal.org/api/views/views.api.php/">API documentation included with the module</a>. It&rsquo;s <em>very</em> thorough, and easy to read. If you feel like you understand how this works, but the doco doesn&rsquo;t quite cover what you&rsquo;re trying to do, look for examples in the Views module itself! There are 169 handlers for every concievable kind of case, just within Views. Find something reasonable and build off of that!</p>
<p>With this in mind, it&rsquo;s only 24 lines of simple code to provide your own handler for an existing field. After that 24 lines, you&rsquo;re doing the same things you were planning to do in views_php&hellip; but now you&rsquo;re doing them in a real coding environment, with a revisioning system, and where it&rsquo;s easy to track down and fix errors that could otherwise crash your site. 24 lines of array definition can save you a world of hurt. I hope to see those views_php installation numbers dropping soon.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/blog/2013/12/20/ssh-lifehacks-to-make-your-ssh-life-easy/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">SSH lifehacks to make your SSH life easy</span>
    </a>
    
    
    <a href="/blog/2014/01/03/how-to-create-a-custom-panels-pane/" class="navigation-next">
      <span class="navigation-tittle">How to create a custom Panels Pane</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  




  
    
        <div id="disqus_thread"></div>
<script type="text/javascript">
    

    (function () {
    if (location.hostname === "localhost" ||
      location.hostname === "127.0.0.1" ||
      location.hostname === "") {
      return;
    }
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    var disqus_shortname = 'ohthehugemanatee';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || 
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<noscript>
  Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
  <span class="logo-disqus">Disqus</span>
</a>

    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" integrity="sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
